<!DOCTYPE html>
<html lang="zxx">

<head>
  <meta charset="utf-8">
  <title>Dtox</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <!-- ** Plugins Needed for the Project ** -->
  <!-- Bootstrap -->
  <link rel="stylesheet" href="Website/plugins/bootstrap/bootstrap.min.css">
  <!-- themefy-icon -->
  <link rel="stylesheet" href="Website/plugins/themify-icons/themify-icons.css">
  <!-- slick slider -->
  <link rel="stylesheet" href="Website/plugins/slick/slick.css">
  <!-- venobox popup -->
  <link rel="stylesheet" href="Website/plugins/Venobox/venobox.css">
  <!-- aos -->
  <link rel="stylesheet" href="Website/plugins/aos/aos.css">
  <!-- load jQuery -->
  <script crossorigin="anonymous"
          integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
          src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet">

  <link href="Website/redips_table/style.css" media="screen" rel="stylesheet" type="text/css"/>

  <!-- Main Stylesheet -->
  <link href="Website/css/style.css" rel="stylesheet">
  
  <!--Favicon-->
  <link rel="shortcut icon" href="Website/images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="Website/images/favicon.ico" type="image/x-icon">

  <script>(function(w,r){w._rwq=r;w[r]=w[r]||function(){(w[r].q=w[r].q||[]).push(arguments)}})(window,'rewardful');</script>
  <script async src='https://r.wdfl.co/rw.js' data-rewardful='a743ae'></script>
</head>

<body>
<script src="Website/redips_table/redips-drag-source.js" type="text/javascript"></script>
<!-- local script -->
<script src="Website/redips_table/script.js" type="text/javascript"></script>
<script src="picker.js" type="text/javascript"></script>

<!-- navigation -->
<section class="fixed-top navigation">
  <div class="container">
    <nav class="navbar navbar-expand-md navbar-light">
      <a class="navbar-brand" href="index.html"><img src="Website/images/logo.png" id="logo" alt="logo"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <!-- navbar -->
      <div class="collapse navbar-collapse text-center" id="navbar">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link page-scroll" href="index.html#feature">Features</a>
          </li>
          <li class="nav-item">
            <a class="nav-link page-scroll" href="index.html#pricing">Pricing</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contact.html">Contact</a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</section>
<!-- /navigation -->

<!-- about us -->
<section class="section-lg about pb-0">
  <h1>Customize Google Sheet</h1>
  <button class="btn btn-success" id="authorize_button" onclick="handleAuthClick()">Pick Spreadsheet</button>
  <button class="btn btn-outline-danger" id="signout_button" onclick="handleSignoutClick()">Disconnect Google Sheet</button>
  <button onclick="saveTable()">Save Table</button>
  <button onclick="fill_headers()">Fill Headers</button>

  <div id="redips-drag">
    <div class="table-responsive md" id="outer">
    <table id="tab">
      <colgroup>
        <col class="a">
        <col class="b">
        <col class="c">
        <col class="d">
        <col class="e">
        <col class="f">
        <col class="g">
        <col class="h">
        <col class="i">
        <col class="j">
        <col class="k">
        <col class="l">
        <col class="m">
        <col class="n">
        <col class="o">
        <col class="p">
        <col class="q">
        <col class="r">
        <col class="s">
        <col class="t">
        <col class="u">
        <col class="v">
        <col class="w">
        <col class="x">
        <col class="y">
        <col class="z">
      </colgroup>
      <tbody>
      <tr>
        <td class="redips-mark">A</td>
        <td class="redips-mark">B</td>
        <td class="redips-mark">C</td>
        <td class="redips-mark">D</td>
        <td class="redips-mark">E</td>
        <td class="redips-mark">F</td>
        <td class="redips-mark">G</td>
        <td class="redips-mark">H</td>
        <td class="redips-mark">I</td>
        <td class="redips-mark">J</td>
        <td class="redips-mark">K</td>
        <td class="redips-mark">L</td>
        <td class="redips-mark">M</td>
        <td class="redips-mark">N</td>
        <td class="redips-mark">O</td>
        <td class="redips-mark">P</td>
        <td class="redips-mark">Q</td>
        <td class="redips-mark">R</td>
        <td class="redips-mark">S</td>
        <td class="redips-mark">T</td>
        <td class="redips-mark">U</td>
        <td class="redips-mark">V</td>
        <td class="redips-mark">W</td>
        <td class="redips-mark">X</td>
        <td class="redips-mark">Y</td>
        <td class="redips-mark">Z</td>
      </tr>
      <tr>
        <td class="redips"><div id="date" class="redips-drag">Date</div></td>
        <td class="redips"><div id="asin" class="redips-drag">ASIN</div></td>
        <td class="redips"><div id="title" class="redips-drag">Product Name</div></td>
        <td class="redips"><div id="roi" class="redips-drag">ROI</div></td>
        <td class="redips"><div id="sr" class="redips-drag">Sales Rank</div></td>
        <td class="redips"><div id="top_per" class="redips-drag">Top %</div></td>
        <td class="redips"><div id="cat_name" class="redips-drag">Category name</div></td>
        <td class="redips"><div id="notes" class="redips-drag">Notes</div></td>
        <td class="redips"><div id="source_url" class="redips-drag">Source URL</div></td>
        <td class="redips"><div id="cogs" class="redips-drag">COGS</div></td>
        <td class="redips"><div id="price" class="redips-drag">Price</div></td>
        <td class="redips"><div id="profit" class="redips-drag">Profit</div></td>
        <td class="redips"><div id="ref_per" class="redips-drag">Referral %</div></td>
        <td class="redips"><div id="ref_fee" class="redips-drag">Referral Fee ($)</div></td>
        <td class="redips"><div id="ship" class="redips-drag">Shipping Fee</div></td>
        <td class="redips"><div id="other_fees" class="redips-drag" >Other Fees</div></td>
        <td class="redips"><div id="tot_fee" class="redips-drag">Total Fee</div></td>
        <td class="redips"><div id="sell_link" class="redips-drag">Seller link</div></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
      </tr>
      </tbody>
    </table>
    </div>

    <table class="other_columns">
      </tbody>
      <tr>
        <td>
          <div class="redips-drag" id="margin">Gross Margin</div>
          <div class="redips-drag" id="sales_tax">Sales Tax</div>
          <div class="redips-drag" id="proceeds">Seller Proceeds</div>
        </td>
      </tr>
      <tbody>
    </table>

    <!-- Rounded switch -->
    Dynamic Stats <i>recommended</i>
    <br>
    <label class="switch">
      <input type="checkbox" checked id="dynam">
      <span class="slider round"></span>
    </label>
  </div>
  <!-- background shapes -->
  <img src="Website/images/background-shape/green-dot.png" alt="background-shape" class="about-bg-1 up-down-animation">
  <img src="Website/images/background-shape/blue-dot.png" alt="background-shape" class="about-bg-2 left-right-animation">
  <img src="Website/images/background-shape/green-half-cycle.png" alt="background-shape" class="about-bg-3 up-down-animation">
  <img src="Website/images/background-shape/seo-ball-1.png" alt="background-shape" class="about-bg-4 left-right-animation">
  <img src="Website/images/background-shape/team-bg-triangle.png" alt="background-shape" class="about-bg-5 up-down-animation">
  <img src="Website/images/background-shape/service-half-cycle.png" alt="background-shape" class="about-bg-6 left-right-animation">
</section>
<!-- /about us -->
</section>

<!-- footer -->
<footer class="footer-section footer" style="background-image: url(Website/images/backgrounds/footer-bg.png);">
  <div class="container">
    <div class="row">
      <div class="col-lg-4 text-center text-lg-left mb-4 mb-lg-0">
        <!-- logo -->
        <a href="index.html">
          <img class="img-fluid" src="Website/images/logo.png" id="logo1" alt="logo">
        </a>
      </div>
      <!-- footer menu -->
      <nav class="col-lg-8 align-self-center mb-5">
        <ul class="list-inline text-lg-right text-center footer-menu">
          <li class="list-inline-item active"><a href="https://www.oa2gsheets.com">Home</a></li>
          <li class="list-inline-item"><a class="page-scroll" href="https://www.oa2gsheets.com/privacy">Privacy</a></li>
          <li class="list-inline-item"><a href="https://oa2gsheets.freshdesk.com/support/solutions">Support</a></li>
        </ul>
      </nav>
      <!-- footer social icon -->
      <nav class="col-12">
        <ul class="list-inline text-lg-right text-center social-icon">
          <li class="list-inline-item">
            <a class="twitter" href="https://twitter.com/OA2Gsheets"><i class="ti-twitter-alt"></i></a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</footer>
<!-- /footer -->
<iframe id="send_headers" src=""></iframe>

<script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
<script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
<script type="text/javascript">
  /* exported gapiLoaded */
  /* exported gisLoaded */
  /* exported handleAuthClick */
  /* exported handleSignoutClick */

  // Authorization scopes required by the API; multiple scopes can be
  // included, separated by spaces.
  const SCOPES = 'https://www.googleapis.com/auth/drive.file profile';

  const CLIENT_ID = '654389885336-re4m337upgk4igdbu3q4jab9id3sp2qd.apps.googleusercontent.com';
  const API_KEY = 'AIzaSyAPnD47lfv1T5oHMAC770fUmSmSiKe9J3w';
  const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';


  const APP_ID = '654389885336';

  let tokenClient;
  let accessToken = null;
  let pickerInited = false;
  let gisInited = false;


  document.getElementById('authorize_button').style.visibility = 'hidden';
  document.getElementById('signout_button').style.visibility = 'hidden';

  /**
   * Callback after api.js is loaded.
   */
  function gapiLoaded() {
    gapi.load('picker', intializePicker);
    gapi.load('client', intializeGapiClient);
  }

  async function intializeGapiClient() {
    await gapi.client.init({
      apiKey: API_KEY,
      clientId: CLIENT_ID,
      scope: SCOPES,
      discoveryDocs: [DISCOVERY_DOC],
    });
    gapiInited = true;
  }

  /**
   * Callback after the API client is loaded. Loads the
   * discovery doc to initialize the API.
   */
  function intializePicker() {
    pickerInited = true;
    maybeEnableButtons();
  }

  /**
   * Callback after Google Identity Services are loaded.
   */
  function gisLoaded() {
    tokenClient = google.accounts.oauth2.initTokenClient({
      client_id: CLIENT_ID,
      scope: SCOPES,
      callback: '',
    });
    gisInited = true;
    maybeEnableButtons();
  }

  /**
   * Enables user interaction after all libraries are loaded.
   */
  function maybeEnableButtons() {
    if (pickerInited && gisInited) {
      document.getElementById('authorize_button').style.visibility = 'visible';
    }
  }

  /**
   *  Sign in the user upon button click.
   */
  function handleAuthClick() {
    tokenClient.callback = async (response) => {
      if (response.error !== undefined) {
        throw (response);
      }
      accessToken = response.access_token;
      document.getElementById('signout_button').style.visibility = 'visible';
      document.getElementById('authorize_button').innerText = 'Refresh';
      await createPicker();
    };

    if (accessToken === null) {
      // Prompt the user to select a Google Account and ask for consent to share their data
      // when establishing a new session.
      tokenClient.requestAccessToken({prompt: 'consent'});
    } else {
      // Skip display of account chooser and consent dialog for an existing session.
      tokenClient.requestAccessToken({prompt: ''});
    }
  }

  /**
   *  Sign out the user upon button click.
   */
  function handleSignoutClick() {
    if (accessToken) {
      accessToken = null;
      google.accounts.oauth2.revoke(accessToken);
      document.getElementById('content').innerText = '';
      document.getElementById('authorize_button').innerText = 'Authorize';
      document.getElementById('signout_button').style.visibility = 'hidden';
    }
  }

  /**
   *  Create and render a Picker object for searching spreadsheets.
   */
  function createPicker() {
    const {DocsView, DocsViewMode} = google.picker
    var view = new DocsView(google.picker.ViewId.SPREADSHEETS)
    view.setMimeTypes("application/vnd.google-apps.spreadsheet");
    view.setMode(DocsViewMode.LIST)
    view.setSelectFolderEnabled(false)
    const picker = new google.picker.PickerBuilder()
            .setAppId(APP_ID)
            .setDeveloperKey(API_KEY)
            .setOAuthToken(accessToken)
            .addView(view)
            //.addView(new google.picker.DocsUploadView())
            .setCallback(pickerCallback)
            .build();
    picker.setVisible(true);
  }

  /**
   * Displays the file details of the user's selection.
   * @param {object} data - Containers the user selection from the picker
   */
  function pickerCallback(data) {
    console.log(data);
    if (data.action == google.picker.Action.PICKED) {
      var fileId = data.docs[0].id;
      document.cookie = "fileID=" + fileId + "; expires=Wed, 26 April 2062 12:00:00 UTC; domain=oa2gsheets.com";
    }
  }
</script>

<script src="OA_Script.js"></script>

<!-- jQuery -->
<script src="Website/plugins/jQuery/jquery.min.js"></script>
<!-- Bootstrap JS -->
<script src="Website/plugins/bootstrap/bootstrap.min.js"></script>
<!-- slick slider -->
<script src="Website/plugins/slick/slick.min.js"></script>
<!-- venobox -->
<script src="Website/plugins/Venobox/venobox.min.js"></script>
<!-- aos -->
<script src="Website/plugins/aos/aos.js"></script>
<!-- Main Script -->
<script src="Website/js/script.js"></script>

</body>
</html>