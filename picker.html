<!DOCTYPE html>
<html lang="zxx">

<head>
  <meta charset="utf-8">
  <title>Google Sheets Customize</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <!-- ** Plugins Needed for the Project ** -->
  <!-- Bootstrap -->
  <link rel="stylesheet" href="Website/plugins/bootstrap/bootstrap.min.css">
  <!-- themefy-icon -->
  <link rel="stylesheet" href="Website/plugins/themify-icons/themify-icons.css">
  <!-- slick slider -->
  <link rel="stylesheet" href="Website/plugins/slick/slick.css">
  <!-- venobox popup -->
  <link rel="stylesheet" href="Website/plugins/Venobox/venobox.css">
  <!-- aos -->
  <link rel="stylesheet" href="Website/plugins/aos/aos.css">
  <!-- load jQuery -->
  <script crossorigin="anonymous"
          integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
          src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet">

  <link href="Website/redips_table/style.css" media="screen" rel="stylesheet" type="text/css"/>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">

  <!-- Main Stylesheet -->
  <link href="Website/css/style.css" rel="stylesheet">
  
  <!--Favicon-->
  <link rel="shortcut icon" href="Website/images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="Website/images/favicon.ico" type="image/x-icon">
  <!--script type="text/javascript" src="https://static.leaddyno.com/js"></script>
  <script> LeadDyno.key = "208e672911ce03d5c3d3d08f247bf5712f30f569"; LeadDyno.recordVisit(); LeadDyno.autoWatch(); </script-->
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3GM0XRPCY8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3GM0XRPCY8');
</script>

<body>
<script src="Website/redips_table/redips-drag-source.js" type="text/javascript"></script>
<!-- local script -->
<script src="Website/redips_table/script.js" type="text/javascript"></script>

<!-- navigation -->
<section id="nav" style="z-index: 3" class="fixed-top navigation">
  <div class="container">
    <nav class="navbar navbar-expand-lg navbar-light">
      <a class="navbar-brand" href="https://www.oa2gsheets.com"><img id= "logo" src="Website/images/logo.png" alt="logo"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar"
              aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <!-- navbar -->
      <div class="collapse navbar-collapse text-center" id="navbar">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="https://www.oa2gsheets.com">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link page-scroll" href="https://www.oa2gsheets.com#features">Features</a>
          </li>
          <li class="nav-item">
            <a class="nav-link page-scroll" href="https://www.oa2gsheets.com#pricing">Pricing</a>
          </li>
          <li class="nav-item">
            <a class="nav-link page-scroll" href="https://www.oa2gsheets.com/reverse">Reverse</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://oa2gsheets.freshdesk.com/support/solutions">Support</a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</section>
<!-- /navigation -->

<!-- about us -->
<section class="section-lg about pb-0">
  <h1>Customize Google Sheet</h1>
  <span class="d-none"><input id="file_id" value=""></span>
  <button class="btn btn-success p-2 mx-2" id="authorize_button" onclick="handleAuthClick()">Link Gsheet</button>
  <span id="buttons">
  <button class="btn btn-info p-2 mx-2" onclick="saveTable()">Save Table</button>
  <i class="fas fa-sync fa-spin d-none" id="table_spinner"></i>
  <button class="btn btn-info p-2 mx-2" onclick="token_then_headers()">Fill Headers</button>
  <i class="fas fa-sync fa-spin d-none" id="headers_spinner"></i>
  </span>
  &emsp; &emsp; &emsp; &emsp;
  <span>Dynamic Stats <i>recommended</i>
  <label class="switch">
    <input type="checkbox" name="dynam" id="dynam" checked>
    <span class="slider round"></span>
  </label>
  </span>

  <div id="redips-drag">
    <div class="table-responsive md" id="outer">
    <table id="tab">
      <colgroup>
        <col class="a">
        <col class="b">
        <col class="c">
        <col class="d">
        <col class="E">
        <col class="f">
        <col class="g">
        <col class="h">
        <col class="i">
        <col class="j">
        <col class="k">
        <col class="l">
        <col class="m">
        <col class="n">
        <col class="o">
        <col class="p">
        <col class="q">
        <col class="r">
        <col class="s">
        <col class="t">
        <col class="u">
        <col class="v">
        <col class="w">
        <col class="x">
        <col class="y">
        <col class="z">
      </colgroup>
      <tbody>
      <tr>
        <td class="redips-mark">A</td>
        <td class="redips-mark">B</td>
        <td class="redips-mark">C</td>
        <td class="redips-mark">D</td>
        <td class="redips-mark">E</td>
        <td class="redips-mark">F</td>
        <td class="redips-mark">G</td>
        <td class="redips-mark">H</td>
        <td class="redips-mark">I</td>
        <td class="redips-mark">J</td>
        <td class="redips-mark">K</td>
        <td class="redips-mark">L</td>
        <td class="redips-mark">M</td>
        <td class="redips-mark">N</td>
        <td class="redips-mark">O</td>
        <td class="redips-mark">P</td>
        <td class="redips-mark">Q</td>
        <td class="redips-mark">R</td>
        <td class="redips-mark">S</td>
        <td class="redips-mark">T</td>
        <td class="redips-mark">U</td>
        <td class="redips-mark">V</td>
        <td class="redips-mark">W</td>
        <td class="redips-mark">X</td>
        <td class="redips-mark">Y</td>
        <td class="redips-mark">Z</td>
      </tr>
      <tr>
        <td class="redips"><div id="date" class="redips-drag ne">Date</div></td>
        <td class="redips"><div id="asin" class="redips-drag ne">ASIN</div></td>
        <td class="redips"><div id="title" class="redips-drag ne">Product Name</div></td>
        <td class="redips"><div id="roi" class="redips-drag ne">ROI</div></td>
        <td class="redips"><div id="sr" class="redips-drag ne">Sales Rank</div></td>
        <td class="redips"><div id="top_per" class="redips-drag ne">Top %</div></td>
        <td class="redips"><div id="cat_name" class="redips-drag ne">Category name</div></td>
        <td class="redips"><div id="notes" class="redips-drag ne">Notes</div></td>
        <td class="redips"><div id="source_url" class="redips-drag ne">Source URL</div></td>
        <td class="redips"><div id="cogs" class="redips-drag e">COGS</div></td>
        <td class="redips"><div id="price" class="redips-drag e">Price</div></td>
        <td class="redips"><div id="profit" class="redips-drag e">Profit</div></td>
        <td class="redips"><div id="ref_per" class="redips-drag e">Referral %</div></td>
        <td class="redips"><div id="ref_fee" class="redips-drag e">Referral Fee ($)</div></td>
        <td class="redips"><div id="ship" class="redips-drag e">Shipping Fee</div></td>
        <td class="redips"><div id="ship_to_amz" class="redips-drag e">Ship to AMZ</div></td>
        <td class="redips"><div id="sales_tax" class="redips-drag e">Sales Tax</div></td>
        <td class="redips"><div id="other_fees" class="redips-drag e" >Other Fees</div></td>
        <td class="redips"><div id="tot_fee" class="redips-drag e">Total Fees</div></td>
        <td class="redips"><div id="sell_link" class="redips-drag ne">Seller link</div></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
        <td class="redips"></td>
      </tr>
      </tbody>
    </table>
    </div>

    <table id="other_columns" class="other_columns">
      <tbody class="float-left">
      <tr>
        <td class="redips-only extras">
          <div class="redips-drag ne" id="margin">Gross Margin</div>
          <div class="redips-drag ne" id="proceeds">Seller Proceeds</div>
          <div class="redips-drag ne" id="drops">Drops</div>
        </td>
      </tr>
      </tbody>
    </table>
    <hr style="width:63%; margin-left: 0">
    <div>
      <h4>Instructions</h4>
      <ol>
        <li>1. &nbsp; &nbsp;<a href="https://sheets.new" target="_blank">Create the Google Sheet <i class="fa-solid fa-arrow-up-right-from-square"></i></a> you intend to use for sourcing, if you haven't already.</li>
        <li>2. &nbsp; Click the "Link Gsheet" button. <em> Note: OA2Gsheets only supports linking to the first worksheet, for now.</em></li>
        <li>3. &nbsp; Sign in to Google & select the Google Sheet you want to link.</li>
        <li>4. &nbsp; Drag the items in the table to the order you want them to appear on your Gsheet. <br> Use the second table to
        remove any items you don't want. Blank columns will be ignored. <a href="https://oa2gsheets.freshdesk.com/support/solutions/articles/73000563574-term-definitions-spreadsheet-columns-product-dashboard" target="_blank">Click here for word definitions <i class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
        <li>5. &nbsp; Decide if you would like to use dynamic stats. This allows certain values to be exported as formulas.
        <br> <em>Note: the items outline in red are required for dynamic stats</em>. <!--More about dynamic stats <a href="#" target="_blank">here <i class="fa-solid fa-arrow-up-right-from-square"></i></a> </li>-->
        <li>6. &nbsp; <strong>IMPORTANT!</strong> Click the "Save Table" button to save the table order.</li>
        <li>7. &nbsp; Click the "Fill Headers" button if you want the headers to populate your spreadsheet in row 1.</li>
        <em><a target="_blank" href="https://oa2gsheets.freshdesk.com/support/solutions/articles/73000566121-why-is-my-google-sheet-not-linking-">Click here for troubleshooting help <i class="fa-solid fa-arrow-up-right-from-square"></i></a></em>

      </ol>

    </div>
    <!-- Rounded switch -->

  <!-- background shapes -->
  <img src="Website/images/background-shape/green-dot.png" alt="background-shape" class="about-bg-1 up-down-animation">
  <img src="Website/images/background-shape/blue-dot.png" alt="background-shape" class="about-bg-2 left-right-animation">
  <img src="Website/images/background-shape/green-half-cycle.png" alt="background-shape" class="about-bg-3 up-down-animation">
  <img src="Website/images/background-shape/seo-ball-1.png" alt="background-shape" class="about-bg-4 left-right-animation">
  <img src="Website/images/background-shape/team-bg-triangle.png" alt="background-shape" class="about-bg-5 up-down-animation">
  <img src="Website/images/background-shape/service-half-cycle.png" alt="background-shape" class="about-bg-6 left-right-animation">
</section>
<!-- /about us -->
</section>

<!-- footer -->
<footer class="footer-section footer" style="background-image: url(Website/images/backgrounds/footer-bg.png);">
  <div class="container">
    <div class="row">
      <div class="col-lg-4 text-center text-lg-left mb-4 mb-lg-0">
        <!-- logo -->
        <a href="https://www.oa2gsheets.com">
          <img class="img-fluid" src="Website/images/logo.png" id="logo1" alt="logo">
        </a>
      </div>
      <!-- footer menu -->
      <nav class="col-lg-8 align-self-center mb-5">
        <ul class="list-inline text-lg-right text-center footer-menu">
          <li class="list-inline-item active"><a href="https://www.oa2gsheets.com">Home</a></li>
          <li class="list-inline-item"><a class="page-scroll" href="https://www.oa2gsheets.com/privacy">Privacy</a></li>
          <li class="list-inline-item"><a href="https://oa2gsheets.freshdesk.com/support/solutions">Support</a></li>
        </ul>
      </nav>
      <!-- footer social icon -->
      <nav class="col-12">
        <ul class="list-inline text-lg-right text-center social-icon">
          <li class="list-inline-item">
            <a class="twitter" href="https://twitter.com/OA2Gsheets"><i class="ti-twitter-alt"></i></a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</footer>
<!-- /footer -->
<iframe id="send_headers" src=""></iframe>

<script type="text/javascript">
  // Authorization scopes required by the API; multiple scopes can be
  // included, separated by spaces.
  const SCOPES = 'https://www.googleapis.com/auth/drive.file profile';

  const CLIENT_ID = '435069937149-jj66oojr9k1cf3dl92d498uuato1d563.apps.googleusercontent.com';
  const API_KEY = 'AIzaSyCVDFngfv325nliz9gbWum6pvTYfjDP_fg';


  const APP_ID = '435069937149';

  let pickerInited = false;
  let gisInited = false;
  let accessToken;


  document.getElementById('authorize_button').style.visibility = 'hidden';

  /**
   * Callback after the API client is loaded. Loads the
   * discovery doc to initialize the API.
   */


  /**
   * Callback after Google Identity Services are loaded.
   */
  function gisLoaded() {
    gisInited = true
    client = google.accounts.oauth2.initTokenClient({
      client_id: CLIENT_ID,
      scope: SCOPES,
      callback: (response) => {
        if (response && response.access_token) {
          gapi.client.setApiKey(API_KEY)
        }
      },
    });
    maybeEnableButtons()
  }

  function onApiLoad() {
    gapi.load('picker', initializePicker);
  }

  function initializePicker() {
    pickerInited = true;
    maybeEnableButtons();
  }
  /**
   * Enables user interaction after all libraries are loaded.
   */
  function maybeEnableButtons() {
    if (pickerInited && gisInited) {
      document.getElementById('authorize_button').style.visibility = 'visible';
    }
  }

  /**
   *  Sign in the user upon button click.
   */
  function handleAuthClick() {
    client.callback = async (response) => {
      if (response.error !== undefined) {
        throw (response);
      }
      accessToken = response.access_token;
      document.getElementById('authorize_button').innerText = 'Link New';
      await createPicker();
    };

    if (accessToken === null) {
      // Prompt the user to select a Google Account and ask for consent to share their data
      // when establishing a new session.
      client.requestAccessToken({prompt: 'consent'});
    } else {
      // Skip display of account chooser and consent dialog for an existing session.
      client.requestAccessToken({prompt: ''});
    }
  }

  /**
   *  Create and render a Picker object for searching spreadsheets.
   */
  function createPicker() {
    const {DocsView, DocsViewMode} = google.picker
    var view = new DocsView(google.picker.ViewId.SPREADSHEETS)
    view.setMimeTypes("application/vnd.google-apps.spreadsheet");
    view.setMode(DocsViewMode.LIST)
    view.setSelectFolderEnabled(false)
    const picker = new google.picker.PickerBuilder()
            .setAppId(APP_ID)
            .setDeveloperKey(API_KEY)
            .setOAuthToken(accessToken)
            .addView(view)
            //.addView(new google.picker.DocsUploadView())
            .setCallback(pickerCallback)
            .build();
    picker.setVisible(true);
  }

  /**
   * Displays the file details of the user's selection.
   * @param {object} data - Containers the user selection from the picker
   */
  function pickerCallback(data) {
    console.log(data);
    if (data.action == google.picker.Action.PICKED) {
      var fileId = data.docs[0].id;
      console.log("PICKER FILE ID:")
      console.log(fileId)
      document.getElementById("file_id").value = fileId
      document.cookie = "fileID=" + fileId + "; expires=Wed, 26 April 2062 12:00:00 UTC; domain=www.oa2gsheets.com";
    }
  }
</script>
<script async defer src="https://apis.google.com/js/api.js" onload="onApiLoad()"></script>
<script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
<script src="picker.js" type="text/javascript"></script>

<!-- jQuery -->
<script src="Website/plugins/jQuery/jquery.min.js"></script>
<!-- Bootstrap JS -->
<script src="Website/plugins/bootstrap/bootstrap.min.js"></script>
<!-- slick slider -->
<script src="Website/plugins/slick/slick.min.js"></script>
<!-- venobox -->
<script src="Website/plugins/Venobox/venobox.min.js"></script>
<!-- aos -->
<script src="Website/plugins/aos/aos.js"></script>
<!-- Main Script -->
<script src="Website/js/script.js"></script>

</body>
</html>