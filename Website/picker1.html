<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Integration</title>
    <meta charset="utf-8"/>
    <!-- load jQuery -->
    <script crossorigin="anonymous"
            integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
            src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet">
    <link href="redips_table/style.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="picker.css" rel="stylesheet">
</head>

<!-- REDIPS.drag -->
<script src="redips_table/redips-drag-source.js" type="text/javascript"></script>
<!-- local script -->
<script src="redips_table/script.js" type="text/javascript"></script>
<script src="picker.js" type="text/javascript"></script>
<body>
<nav>
    <a href="send.html">Sign In</a>
    <a href="input.html">Input Box</a>
    <a href="picker.html">Pick Spreadsheet</a>
    <br/>
</nav>
<button onclick="saveTable()">Save Table</button>

<!--Add buttons to initiate auth sequence and sign out-->
<button id="authorize_button" onclick="handleAuthClick()">Pick Spreadsheet</button>
<button id="signout_button" onclick="handleSignoutClick()">Sign Out</button>

<pre id="content" style="white-space: pre-wrap;"></pre>

<div id="redips-drag">
    <table id="tab">
        <colgroup>
            <col class="a">
            <col class="b">
            <col class="c">
            <col class="d">
            <col class="e">
            <col class="f">
            <col class="g">
            <col class="h">
            <col class="i">
            <col class="j">
            <col class="k">
            <col class="l">
            <col class="m">
            <col class="n">
            <col class="o">
            <col class="p">
            <col class="q">
            <col class="r">
            <col class="s">
            <col class="t">
            <col class="u">
            <col class="v">
            <col class="w">
            <col class="x">
            <col class="y">
            <col class="z">
        </colgroup>
        <tbody>
        <tr>
            <td class="redips-mark">A</td>
            <td class="redips-mark">B</td>
            <td class="redips-mark">C</td>
            <td class="redips-mark">D</td>
            <td class="redips-mark">E</td>
            <td class="redips-mark">F</td>
            <td class="redips-mark">G</td>
            <td class="redips-mark">H</td>
            <td class="redips-mark">I</td>
            <td class="redips-mark">J</td>
            <td class="redips-mark">K</td>
            <td class="redips-mark">L</td>
            <td class="redips-mark">M</td>
            <td class="redips-mark">N</td>
            <td class="redips-mark">O</td>
            <td class="redips-mark">P</td>
            <td class="redips-mark">Q</td>
            <td class="redips-mark">R</td>
            <td class="redips-mark">S</td>
            <td class="redips-mark">T</td>
            <td class="redips-mark">U</td>
            <td class="redips-mark">V</td>
            <td class="redips-mark">W</td>
            <td class="redips-mark">X</td>
            <td class="redips-mark">Y</td>
            <td class="redips-mark">Z</td>
        </tr>
        <tr>
            <td class="redips"><div id="date" class="redips-drag">Date</div></td>
            <td class="redips"><div id="asin" class="redips-drag">ASIN</div></td>
            <td class="redips"><div id="title" class="redips-drag">Product Name</div></td>
            <td class="redips"><div id="roi" class="redips-drag">ROI</div></td>
            <td class="redips"><div id="sr" class="redips-drag">Sales Rank</div></td>
            <td class="redips"><div id="cat_name" class="redips-drag">Category name</div></td>
            <td class="redips"><div id="source_url" class="redips-drag">Source URL</div></td>
            <td class="redips"><div id="cogs" class="redips-drag">COGS</div></td>
            <td class="redips"><div id="price" class="redips-drag">Price</div></td>
            <td class="redips"><div id="profit" class="redips-drag">Profit</div></td>
            <td class="redips"><div id="ref_per" class="redips-drag">Referral %</div></td>
            <td class="redips"><div id="notes" class="redips-drag">Notes</div></td>
            <td class="redips"><div id="ref_fee" class="redips-drag">Referral Fee ($)</div></td>
            <td class="redips"><div id="ship" class="redips-drag">Shipping</div></td>
            <td class="redips"><div id="tot_fee" class="redips-drag">Total Fee</div></td>
            <td class="redips"><div id="sell_link" class="redips-drag">Seller link</div></td>
            <td class="redips"></td>
            <td class="redips"></td>
            <td class="redips"></td>
            <td class="redips"></td>
            <td class="redips"></td>
            <td class="redips"></td>
            <td class="redips"></td>
            <td class="redips"></td>
            <td class="redips"></td>
            <td class="redips"></td>
        </tr>
        </tbody>
    </table>

    <table class="other_columns">
        </tbody>
            <tr>
                <td>
                    <div class="redips-drag" id="margin">Gross Margin</div>
                    <div class="redips-drag" id="other_fees">Other Fees</div>
                    <div class="redips-drag" id="sales_tax">Sales Tax</div>
                    <div class="redips-drag" id="proceeds">Seller Proceeds</div>
                    <div class="redips-drag">test</div>
                    <div class="redips-drag"></div>
                    <div class="redips-drag"></div>
                    <div class="redips-drag"></div>
                </td>
            </tr>
        <tbody>
    </table>

    <!-- Rounded switch -->
    Dynamic Stats <i>recommended</i>
    <br>
    <label class="switch">
        <input type="checkbox" checked>
        <span class="slider round"></span>
    </label>
</div>
// The Browser API key obtained from the Google API Console.
// Replace with your own Browser API key, or your own key.
var developerKey = '//Your Api Key//';

// The Client ID obtained from the Google API Console. Replace with your own Client ID.
var clientId = "//Your Client Id//"

// Replace with your own project number from console.developers.google.com.
// See "Project number" under "IAM & Admin" > "Settings"
var appId = "//Your Project ID";

// Scope to use to access user's Drive items.
var scope = ['https://www.googleapis.com/auth/drive.file'];

var pickerApiLoaded = false;
var oauthToken;

// Use the Google API Loader script to load the google.picker script.
function loadPicker() {
gapi.load('auth', {'callback': onAuthApiLoad});
gapi.load('picker', {'callback': onPickerApiLoad});
}

function onAuthApiLoad() {
window.gapi.auth.authorize(
{
'client_id': clientId,
'scope': scope,
'immediate': false
},
handleAuthResult);
}

function onPickerApiLoad() {
pickerApiLoaded = true;
createPicker();
}

function handleAuthResult(authResult) {
if (authResult && !authResult.error) {
oauthToken = authResult.access_token;
createPicker();
}
}

// Create and render a Picker object for searching images.
function createPicker() {
if (pickerApiLoaded && oauthToken) {
var view = new google.picker.View(google.picker.ViewId.DOCS);
view.setMimeTypes("image/png,image/jpeg,image/jpg");
var picker = new google.picker.PickerBuilder()
.enableFeature(google.picker.Feature.NAV_HIDDEN)
.enableFeature(google.picker.Feature.MULTISELECT_ENABLED)
.setAppId(appId)
.setOAuthToken(oauthToken)
.addView(view)
.addView(new google.picker.DocsUploadView())
.setDeveloperKey(developerKey)
.setCallback(pickerCallback)
.build();
picker.setVisible(true);
}
}

// A simple callback implementation.
function pickerCallback(data) {
if (data.action == google.picker.Action.PICKED) {
var fileId = data.docs[0].id;
alert('The user selected: ' + fileId);
}
}
</script>
</head>
<body>
<div id="result"></div>
<button onclick="showPickerDialog()">Show Picker Dialog</button>

<!-- The Google API Loader script. -->
<script type="text/javascript" src="https://apis.google.com/js/api.js"></script>
<script>
    function showPickerDialog(){
        loadPicker()
    }
</script>
</script>
</body>
</html>